-- ================================================================
-- RE:FACTOR EVENT TAB
-- Auto-integrates with main script when globals are available
-- ================================================================

-- Wait for main script to be ready
local function waitForMainScript()
    local maxWait = 30 -- Maximum 30 seconds
    local waited = 0
    
    while waited < maxWait do
        -- Check multiple possible global locations
        local Library = getgenv and getgenv().Library or _G.Library
        local Window = getgenv and getgenv().Window or _G.Window
        local Tabs = getgenv and getgenv().Tabs or _G.Tabs
        local MainScriptLoaded = getgenv and getgenv().MainScriptLoaded or _G.MainScriptLoaded
        
        if Library and Window and Tabs and MainScriptLoaded then
            print("âœ… Event Tab: Main script globals found!")
            return Library, Window, Tabs
        end
        
        task.wait(0.5)
        waited = waited + 0.5
    end
    
    error("âŒ Event Tab: Main script not ready after " .. maxWait .. " seconds")
end

-- Get references to main script components
local Library, Window, Tabs = waitForMainScript()

-- ================================================================
-- CREATE EVENT TAB
-- ================================================================
local EventTab = Window:AddTab("Event")

-- ================================================================
-- EVENT TAB CONTENT (Currently Empty)
-- ================================================================
local EventGroupBox = EventTab:AddLeftGroupbox("Event System")

-- Placeholder content - ready for future event features
EventGroupBox:AddLabel("ðŸŽ‰ Event Tab Ready!")
EventGroupBox:AddLabel("This tab is prepared for:")
EventGroupBox:AddLabel("â€¢ Seasonal events")
EventGroupBox:AddLabel("â€¢ Special challenges") 
EventGroupBox:AddLabel("â€¢ Time-limited rewards")
EventGroupBox:AddLabel("â€¢ Event automation")

EventGroupBox:AddDivider()

-- Example event features (disabled for now)
EventGroupBox:AddButton("ðŸŽ¯ Event Features Coming Soon", function()
    Library:Notify("ðŸŽ‰ Event features will be added here soon!", 3)
end)

-- Event Status GroupBox
local EventStatusGroupBox = EventTab:AddRightGroupbox("Event Status")

EventStatusGroupBox:AddLabel("ðŸ“… Current Events:")
EventStatusGroupBox:AddLabel("â€¢ No active events detected")
EventStatusGroupBox:AddLabel("")
EventStatusGroupBox:AddLabel("ðŸ”” Event Notifications:")
EventStatusGroupBox:AddLabel("â€¢ System ready for alerts")

EventStatusGroupBox:AddDivider()

EventStatusGroupBox:AddButton("ðŸ”„ Refresh Event Status", function()
    Library:Notify("ðŸ”„ Checking for active events...", 2)
    -- Future: Add event detection logic here
    task.wait(1)
    Library:Notify("ðŸ“… Event status updated!", 2)
end)

-- ================================================================
-- EVENT TAB INITIALIZATION COMPLETE
-- ================================================================
print("ðŸŽ‰ Event Tab initialized successfully!")
Library:Notify("ðŸŽ‰ Event Tab loaded! Ready for future events.", 3)

-- Return success indicator
return true
